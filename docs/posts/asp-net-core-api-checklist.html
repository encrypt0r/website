
<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />

        <title>Muhammad Azeez - ASP.NET Core API Checklist</title>
        <meta name="description" content="A blog about software engineering and beyond!" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link type="application/rss+xml" rel="alternate" title="Muhammad Azeez"
                href="/feed.rss" />
                <link type="application/atom+xml" rel="alternate" title="Muhammad Azeez"
                href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet'
                type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800'
                rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Muhammad Azeez" />
        <meta name="msapplication-tooltip" content="Muhammad Azeez" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Muhammad Azeez - ASP.NET Core API Checklist" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://mazeez.dev/posts/asp-net-core-api-checklist" />
        <!-- TODO: More social graph meta tags -->

        <script src="/assets/js/jquery.min.js"> </script> <script
                src="/assets/js/bootstrap.min.js"> </script> <script
                src="/assets/js/highlight.pack.js"> </script> <script
                src="/assets/js/clean-blog.js"> </script> <script
                src="/assets/js/d3.v3.min.js"> </script> <script
                src="/assets/js/trianglify.min.js"> </script> <script
                src="/assets/js/Please-compressed.js"> </script> <script
                src="/assets/js/background-check.min.js"> </script> <!-- HTML5 Shim and Respond.js
                IE8 support of HTML5 elements and media queries -->
                <!-- WARNING: Respond.js doesn't work if you view the page via file:// 
                -->
        <!--[if lt IE 9]>
                <script src="/assets/js/html5shiv.js"></script>
                <script src="/assets/js/respond.min.js"></script>
        <![endif]-->

        


</head>

<body>

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                <div class="container-fluid">
                        <!-- Brand and toggle get grouped for better mobile display -->
                        <div class="navbar-header page-scroll">
                                <button type="button" class="navbar-toggle" data-toggle="collapse"
                                        data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                </button>
                                <a class="navbar-brand" href="/">Muhammad Azeez
                                        </a> </div> <!-- Collect the nav links, forms, and other content for toggling
                                        -->
                                        <div class="collapse navbar-collapse" id="navbar-collapse">
                                                <ul class="nav navbar-nav navbar-right">
                                                                <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About Me</a></li>

                                                </ul>
                                        </div>
                                        <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
        </nav>

        <!-- Page Header -->
        <header class="intro-header" id="intro-header" style="background-image: url(&quot;/assets/images/cover.jpg&quot;)">
                <div class="container">
                        <div class="row">
                                <div class="col-md-12">

    
<div class="post-heading">
    <h1>ASP.NET Core API Checklist</h1>
    <div class="meta">        
Published on Sunday, 13 June 2021<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/aspnet" class="btn btn-default btn-xs">aspnet</a>
        </div>     
</div>
                                </div>
                        </div>
                </div>
        </header>

        <!-- Main Content -->
        <div class="container">
                <div class="row">
                        <div id="content" class="col-md-12">
                                

<p>Building modern APIs require a lot of things to make them reliable, observable, and scalable. In no particular order, here are some of them that help you build better APIs:</p>
<h2 id="healthchecks">1. Healthchecks</h2>
<p>Healthchecks are important in making sure that we know when anything happens to our APIs. We can setup dashboards to monitor them and setup alerting to let us know when one of the APIs is unhealthy. They are also important when deploying your apps to kubernetes. Kubernetes can monitor healthchecks of your APIs and automatically try to kill the unhealthy instances and create new instances to take their place.</p>
<p>There are two kinds of healthchecks:</p>
<ul>
<li><p><strong>Liveliness:</strong> indicates if your API has crashed and must be restarted.</p>
</li>
<li><p><strong>Readiness:</strong> indicates if your API has been intialized and is ready for processing requests. When launching a new instance of an API, it might need some time to intialize dependencies and load data to be ready.</p>
</li>
</ul>
<h3 id="more-information">More Information:</h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/health-checks">MS Docs - Health checks in ASP.NET Core</a></li>
<li><a href="https://www.youtube.com/watch?v=Kbfto6Y2xdw">IAmTimCorey - Intro to Health Checks in .NET Core</a></li>
</ul>
<h2 id="logging">2. Logging</h2>
<p>Logging provides valuable information when trying to debug unexpected behavior. But too much logging can significantly slow down our APIs. For that reason we can set the logging level to <code>Warning</code> in production and only lower it when we need to.</p>
<p>By default ASP.NET Core provides an abstraction layer for logging that supports <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging/?view=aspnetcore-5.0#log-message-template">Structured Logging</a>.</p>
<p>A very popular logging library that many people use with ASP.NET Core is <a href="https://serilog.net/">Serilog</a>. Serilog has more <a href="https://github.com/serilog/serilog/wiki/Provided-Sinks">Sinks</a> than the default ASP.NET Core loggging abstraction and can easily be integrated with ASP.NET Core.</p>
<h3 id="more-information-1">More information:</h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging">MS Docs - Logging in .NET Core and ASP.NET Core</a></li>
<li><a href="https://www.youtube.com/watch?v=_iryZxv8Rxw">IAmTimCorey - C# Logging with Serilog and Seq - Structured Logging Made Easy</a></li>
</ul>
<h2 id="observability">3. Observability</h2>
<p>This includes a few things:
2. Performance monitoring (P99, P95, P50)
3. Metrics: Specific counters you or your business cares about
4. Tracing: Being able to see the entire lifecycle of each request from frontend to API to data source.</p>
<p><a href="https://opentelemetry.io/">OpenTelemetry</a> is an open standard for doing all of the above and <a href="https://devblogs.microsoft.com/aspnet/observability-asp-net-core-apps/">ASP.NET Core supports it</a>. The good news is, if you use OpenTelemetry, there is a rich ecosystem of tools and services that you can integrate with.</p>
<p>All of the major cloud providers have services that you can use to view the captured data.</p>
<h2 id="error-reporting">4. Error reporting</h2>
<p>There are tools specifically for capturing, storing and showing exceptions that have been raised in your APIs. They the exceptions by their type and location and show how many times they have occurred. Some tools include:</p>
<ul>
<li><a href="https://sentry.io">Sentry</a></li>
<li><a href="https://rollbar.com/">Rollbar</a></li>
<li><a href="https://raygun.com/">Raygun</a></li>
</ul>
<h2 id="status-endpoint">5. Status Endpoint</h2>
<p>It's also good to have a status endpoint in your API that shows the name of the API, version of the API and when was it started. This can be used to create a dashboard showing all of the different services and their versions. Something like this:</p>
<pre><code class="language-csharp">using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;

using System;
using System.Diagnostics;

namespace MyCoolApi.Controllers
{
    public class StatusResponse
    {
        public string Name { get; set; }
        public string Version { get; set; }
        public DateTime StartTime { get; set; }
        public string Host { get; set; }
    }

    [ApiController]
    [Route(&quot;status&quot;)]
    public class StatusController
    {
        [HttpGet]
        public StatusResponse Get()
        {
            var version = typeof(Startup).Assembly.GetName().Version;

            return new StatusResponse
            {
                Name = &quot;my-cool-api&quot;,
                Version = $&quot;{version.Major}.{version.Minor}.{version.Build}&quot;,
                StartTime = Process.GetCurrentProcess().StartTime,
                Host = Environment.MachineName
            };
        }
    }
}
</code></pre>
<h2 id="http-resiliency">6. Http Resiliency</h2>
<p>Although it's generally preferred for your APIs to communicate with other APIs using asynchronous messaging, sometimes you need to call other APIs using HTTP calls.</p>
<p>We need to bake in some level of resiliency by automatically retrying transient failures. This can easily be done by using something like <a href="https://github.com/App-vNext/Polly">Polly</a>.</p>
<h3 id="more-information-2">More information:</h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/dotnet/architecture/microservices/implement-resilient-applications/implement-http-call-retries-exponential-backoff-polly">Implement HTTP call retries with exponential backoff with IHttpClientFactory and Polly policies</a></li>
<li><a href="https://app.pluralsight.com/library/courses/polly-fault-tolerant-web-service-requests">Bryan Hogan - Fault Tolerant Web Service Requests with Polly</a></li>
</ul>
<h2 id="statelessness-and-containerization">7. Statelessness and Containerization</h2>
<p>Containers are a great way to make sure your APIs can be easily scaled out and deployed to multiple environments in a repeatable manner. However to make sure you can get the most out of containerization you should try to make sure your APIs are stateless.</p>
<p>Being stateless means that they don't hold any critical data in memory. For caching you can use a centralized caching technology like <a href="https://redis.io/">Redis</a> instead. This way you can start as many instances as you need without worrying about having stale cached data or data duplication.</p>
<p>You must also be careful about background jobs. You must make sure the different instances don't process background jobs multiple times. And for message queues, you have to implement the <a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/competing-consumers">Competing Consumers</a> pattern which some message buses support natively.</p>
<h3 id="more-information-3">More information:</h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/dotnet/core/docker/build-container">MS Docs - Tutorial: Containerize a .NET Core app</a></li>
<li><a href="https://www.hangfire.io/">Hangfire</a></li>
<li><a href="https://www.quartz-scheduler.net/">Quartz.NET</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/competing-consumers">MS Docs - Competing Consumers</a></li>
</ul>
<h2 id="openapi-spec-swagger">9. OpenAPI Spec / Swagger</h2>
<p>Documenting your APIs is very important. Swagger integrates with ASP.NET Core and automatically finds all of the routes (Controller actions) and shows them in a beautiful dashboard that you can customize.</p>
<h3 id="more-information-4">More information:</h3>
<ul>
<li><a href="(https://docs.microsoft.com/en-us/aspnet/core/tutorials/web-api-help-pages-using-swagger?view=aspnetcore-5.0)">MS Docs - ASP.NET Core web API documentation with Swagger / OpenAPI</a></li>
<li><a href="https://www.pluralsight.com/courses/aspdotnet-core-api-openapi-swagger">Kevin Dockx - Documenting an ASP.NET Core API with OpenAPI / Swagger</a></li>
</ul>
<h2 id="configuration-and-options">10. Configuration and Options</h2>
<p>ASP.NET Core has an extensible configuration mechanism. It can pull configurations from json files, environment variables and command line arguments. You can also provide custom sources for configuration. It also provide ways to easily fetch the configurations in a type-safe manner. it also provides an easy mechanism to <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/options?view=aspnetcore-5.0#options-validation">validate the configuration sections</a>.</p>
<h3 id="more-information-5">More information:</h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration/options">MS Docs - Options Pattern in ASP.NET Core</a></li>
<li><a href="https://app.pluralsight.com/library/courses/dotnet-core-aspnet-core-configuration-options/">Steve Gordon - Using Configuration and Options in .NET Core and ASP.NET Core Apps</a></li>
</ul>
<h2 id="integration-and-unit-tests">11. Integration and Unit Tests</h2>
<p>ASP.NET Core has made it easy to write Unit tests by making the whole framework DI friendly. It has also made Integration tests easy by <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.testing.webapplicationfactory-1"><code>WebApplicationFactory</code></a> Having automated tests saves a lot of time and makes your APIs more robust. And when writing integration tests, try to use the same database technology that you use for production. If you're using Postgres in production, don't use Sqlite or In-Memory DB Providers for integration tests.</p>
<h3 id="more-information-6">More information:</h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/aspnet/core/test/integration-tests">MS Docs - Integration tests in ASP.NET Core</a></li>
<li><a href="https://app.pluralsight.com/library/courses/integration-testing-asp-dot-net-core-applications-best-practices/table-of-contents">Steve Gordon - Integration Testing ASP.NET Core Applications: Best Practices</a></li>
</ul>
<h2 id="build-beautiful-rest-apis">12. Build beautiful REST APIs</h2>
<p>If you're building REST APIs, there are some conventions that make your APIs more pleasant and intuitive to use.</p>
<h3 id="more-information-7">More information:</h3>
<ul>
<li><a href="https://stackoverflow.blog/2020/03/02/best-practices-for-rest-api-design/">Stackoverflow Blog - Best practices for REST API design</a></li>
</ul>


<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'mazeez'; // required: replace example with your forum shortname
    var disqus_identifier = 'asp-net-core-api-checklist';
    var disqus_title = 'ASP.NET Core API Checklist';
    var disqus_url = 'https://mazeez.dev/posts/asp-net-core-api-checklist';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                        </div>
                </div>
        </div>

        <hr>

        <!-- Footer -->
        <footer>
                <ul class="list-inline text-center">
                        <li>
                                <a href="https://twitter.com/mhmd_azeez">
                                        <span class="fa-stack fa-lg">
                                                <i class="fa fa-circle fa-stack-2x"></i>
                                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                        </span>
                                </a>
                        </li>

                        <li>
                                <a href="https://github.com/mhmd-azeez">
                                        <span class="fa-stack fa-lg">
                                                <i class="fa fa-circle fa-stack-2x"></i>
                                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                        </span>
                                </a>
                        </li>

                        
                        <li>
                                <a href="mailto:muhammad-azeez@outlook.com">
                                        <span class="fa-stack fa-lg">
                                                <i class="fa fa-circle fa-stack-2x"></i>
                                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                                        </span>
                                </a>
                        </li>

                        
                        <li>
                                <a href="https://www.linkedin.com/in/muhammad-azeez/">
                                        <span class="fa-stack fa-lg">
                                                <i class="fa fa-circle fa-stack-2x"></i>
                                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                        </span>
                                </a>
                        </li>
                </ul>

                <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © 2021
                        <br />
                            <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by Wyam</a></strong>
                    </p>
                </div>
        </div>
</div>

        </footer>

        
        <script>
                hljs.initHighlightingOnLoad();
                hljs.configure({
                        languages: []
                });
        </script>


        <script>
                BackgroundCheck.init({
                        targets: '.intro-header,.navbar',
                        images: '.intro-header'
                });
        </script>

        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-141113720-1"></script>
        <script>
                window.dataLayer = window.dataLayer || [];

                function gtag() {
                        dataLayer.push(arguments);
                }
                gtag('js', new Date());

                gtag('config', 'UA-141113720-1');
        </script>

</body>

</html>